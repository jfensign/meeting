// Generated by CoffeeScript 1.10.0
(function() {
  var components, config, mongoose, routes, start, throng;

  throng = require('throng');

  config = require('./config');

  mongoose = require('mongoose');

  routes = require('./routes');

  components = require('./components');

  start = function() {
    var server;
    console.log("Worker Started");
    process.on('SIGTERM', function() {
      console.log('Worker Terminated');
      return process.exit();
    });
    mongoose.connect(config.db.endpoint, function(e, res) {
      if (e) {
        return console.error("MongoDB Error: Error connecting to %s. %s", config.db.endpoint, e);
      }
    });
    server = new components.server(config, routes);
    return server.run();
  };

  throng(start, config.app.web_concurrency);

}).call(this);
